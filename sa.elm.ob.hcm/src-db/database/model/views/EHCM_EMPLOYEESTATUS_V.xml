<?xml version="1.0"?>
  <database name="VIEW EHCM_EMPLOYEESTATUS_V">
    <view name="EHCM_EMPLOYEESTATUS_V"><![CDATA[SELECT b.value, b.ad_client_id, b.ad_org_id, b.isactive, b.created, b.createdby, b.updated, b.updatedby, b.status AS name, b.ehcm_employeestatus_v_id, b.statusvalue, b.row_num, b.ad_ref_list_id FROM (SELECT a.value, a.ad_client_id, a.ad_org_id, a.isactive, a.created, a.createdby, a.updated, a.updatedby, a.status, a.ehcm_employeestatus_v_id, a.statusvalue, row_number() OVER (PARTITION BY a.ehcm_employeestatus_v_id ORDER BY (CASE WHEN a.statusvalue = 'ABS' THEN 1 WHEN a.statusvalue = 'BM' THEN 2 WHEN a.statusvalue = 'SCTR' THEN 3 ELSE 4 END)) AS row_num, a.ad_ref_list_id FROM (SELECT per.value, per.ad_client_id, per.ad_org_id, per.isactive, per.created, per.createdby, per.updated, per.updatedby, list.name AS status, per.ehcm_emp_perinfo_id AS ehcm_employeestatus_v_id, list.value AS statusvalue, list.ad_ref_list_id FROM ehcm_emp_perinfo per JOIN ehcm_emp_leave lev ON lev.ehcm_emp_perinfo_id = per.ehcm_emp_perinfo_id JOIN ehcm_emp_leaveln levln ON levln.ehcm_emp_leave_id = lev.ehcm_emp_leave_id, ad_ref_list list WHERE to_date(to_char(now(), 'dd-MM-yyyy')) >= levln.startdate AND to_date(to_char(now(), 'dd-MM-yyyy')) <= levln.enddate AND list.ad_reference_id = '57889F5818294AE6B371B3FD3369E8B3' AND list.value = 'ABS' UNION SELECT per.value, per.ad_client_id, per.ad_org_id, per.isactive, per.created, per.createdby, per.updated, per.updatedby, list.name AS status, per.ehcm_emp_perinfo_id AS ehcm_employeestatus_v_id, list.value AS statusvalue, list.ad_ref_list_id FROM ehcm_emp_perinfo per JOIN ehcm_busmission_summary busmission ON busmission.ehcm_emp_perinfo_id = per.ehcm_emp_perinfo_id, ad_ref_list list WHERE to_date(to_char(now(), 'dd-MM-yyyy')) >= busmission.startdate AND to_date(to_char(now(), 'dd-MM-yyyy')) <= busmission.enddate AND list.ad_reference_id = '57889F5818294AE6B371B3FD3369E8B3' AND list.value = 'BM' UNION SELECT per.value, per.ad_client_id, per.ad_org_id, per.isactive, per.created, per.createdby, per.updated, per.updatedby, list.name AS status, per.ehcm_emp_perinfo_id AS ehcm_employeestatus_v_id, list.value AS statusvalue, list.ad_ref_list_id FROM ehcm_emp_perinfo per JOIN ehcm_scholarship_summary scholarship ON scholarship.ehcm_emp_perinfo_id = per.ehcm_emp_perinfo_id, ad_ref_list list WHERE to_date(to_char(now(), 'dd-MM-yyyy')) >= scholarship.startdate AND to_date(to_char(now(), 'dd-MM-yyyy')) <= scholarship.enddate AND list.ad_reference_id = '57889F5818294AE6B371B3FD3369E8B3' AND list.value = 'SCTR' UNION SELECT per.value, per.ad_client_id, per.ad_org_id, per.isactive, per.created, per.createdby, per.updated, per.updatedby, list.name AS status, per.ehcm_emp_perinfo_id AS ehcm_employeestatus_v_id, list.value AS statusvalue, list.ad_ref_list_id FROM ehcm_emp_perinfo per LEFT JOIN ehcm_employment_info info ON info.ehcm_emp_perinfo_id = per.ehcm_emp_perinfo_id LEFT JOIN (SELECT statusv_1.status, statusv_1.ehcm_emp_perinfo_id FROM ehcm_empstatus_v statusv_1 JOIN ehcm_emp_perinfo statemp ON statemp.ehcm_emp_perinfo_id = statusv_1.ehcm_emp_perinfo_id WHERE statemp.isactive = 'N' AND statusv_1.status = 'C') statusv ON statusv.ehcm_emp_perinfo_id = per.ehcm_emp_perinfo_id, ad_ref_list list WHERE CASE WHEN per.isactive = 'N' AND info.status = 'TE' OR per.isactive = 'N' THEN info.created = ((SELECT max(maxinfo.created) AS max FROM ehcm_employment_info maxinfo WHERE maxinfo.ehcm_emp_perinfo_id = info.ehcm_emp_perinfo_id)) ELSE to_date(to_char(now(), 'dd-MM-yyyy')) >= info.startdate AND to_date(to_char(now(), 'dd-MM-yyyy')) <= COALESCE(info.enddate, '2058-06-21 00:00:00') END AND list.ad_reference_id = '57889F5818294AE6B371B3FD3369E8B3' AND CASE WHEN statusv.status IS NOT NULL THEN list.value = statusv.status ELSE list.value = info.changereason END AND per.status <> 'UP') a) b WHERE b.row_num = 1]]></view>
  </database>
